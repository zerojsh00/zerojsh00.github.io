<!DOCTYPE html><html lang="ko" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="공부하며 정리하는 인과추론 02" /><meta name="author" content="simon sanghyeon" /><meta property="og:locale" content="ko" /><meta name="description" content="이 포스트는 개인적으로 공부한 내용을 정리하고 필요한 분들에게 지식을 공유하기 위해 작성되었습니다. 지적하실 내용이 있다면, 언제든 댓글 또는 메일로 알려주시기를 바랍니다." /><meta property="og:description" content="이 포스트는 개인적으로 공부한 내용을 정리하고 필요한 분들에게 지식을 공유하기 위해 작성되었습니다. 지적하실 내용이 있다면, 언제든 댓글 또는 메일로 알려주시기를 바랍니다." /><link rel="canonical" href="https://zerojsh00.github.io/posts/Causal-Inference-02/" /><meta property="og:url" content="https://zerojsh00.github.io/posts/Causal-Inference-02/" /><meta property="og:site_name" content="Simon’s Research Center" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-05-03T00:00:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="공부하며 정리하는 인과추론 02" /><meta name="twitter:site" content="@" /><meta name="twitter:creator" content="@simon sanghyeon" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"simon sanghyeon"},"dateModified":"2022-05-09T10:17:37+09:00","datePublished":"2022-05-03T00:00:00+09:00","description":"이 포스트는 개인적으로 공부한 내용을 정리하고 필요한 분들에게 지식을 공유하기 위해 작성되었습니다. 지적하실 내용이 있다면, 언제든 댓글 또는 메일로 알려주시기를 바랍니다.","headline":"공부하며 정리하는 인과추론 02","mainEntityOfPage":{"@type":"WebPage","@id":"https://zerojsh00.github.io/posts/Causal-Inference-02/"},"url":"https://zerojsh00.github.io/posts/Causal-Inference-02/"}</script><title>공부하며 정리하는 인과추론 02 | Simon's Research Center</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Simon's Research Center"><meta name="application-name" content="Simon's Research Center"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script> <script type="text/x-mathjax-config"> MathJax.Hub.Config({ TeX: { equationNumbers: { autoNumber: "AMS" } }, tex2jax: { inlineMath: [ ['$', '$'] ], displayMath: [ ['$$', '$$'] ], processEscapes: true, } }); MathJax.Hub.Register.MessageHook("Math Processing Error",function (message) { alert("Math Processing Error: "+message[1]); }); MathJax.Hub.Register.MessageHook("TeX Jax - parse error",function (message) { alert("Math Processing Error: "+message[1]); }); </script> <script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"> </script><meta name="google-site-verification" content="J_a4XJ2oefe52p6EYvjTFdh9LW5Yc5RyGg1HpQOjWaA" /><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/avatar.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Simon's Research Center</a></div><div class="site-subtitle font-italic">성장하는 연구원의 공책</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/zerojsh00" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['zerojsh00','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>공부하며 정리하는 인과추론 02</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>공부하며 정리하는 인과추론 02</h1><div class="post-meta text-muted"><div> By <em> Sanghyeon </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1651503600" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-05-03 </em> </span> <span> Updated <em class="timeago" data-ts="1652059057" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-05-09 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="5240 words"> <em>29 min</em> read</span></div></div></div><div class="post-content"><p>이 포스트는 개인적으로 공부한 내용을 정리하고 필요한 분들에게 지식을 공유하기 위해 작성되었습니다.<br /> 지적하실 내용이 있다면, 언제든 댓글 또는 메일로 알려주시기를 바랍니다.</p><blockquote><p>본 포스트의 상당 내용은 <a href="https://www.youtube.com/channel/UCkEHnPq2T8Vpafk3p-Rk49A"><code class="language-plaintext highlighter-rouge">인과추론의 데이터과학</code></a> 강의를 정리한 것임을 밝힙니다.</p></blockquote><h1 id="지난-이야기">지난 이야기</h1><p>복잡한 IT 환경에서 이상징후 및 장애가 발생되었을 때, 이를 인과추론의 방식으로 해결해보고자 하는 큰 꿈을 품고 첫 포스트인 <a href="https://zerojsh00.github.io/posts/Causal-Inference-01/">공부하며 정리하는 인과추론 01</a>을 올렸습니다. 기계학습 기법에 익숙했던 필자에게는 다소 생소한 데이터 분석 분야라는 것을 알게되었고, 어렵지만 차근차근 공부하며 정복해보고자 하는 욕심이 생겼습니다. 또한 추천시스템 도입 사례와 심슨의 역설 예제를 통해서 인과관계를 어떻게 정의하는지에 따라 인과추론 결과가 달라질 수 있다는 점도 살펴보았습니다.</p><p>이번 포스트에서는 인과추론의 양대산맥인 <code class="language-plaintext highlighter-rouge">Potential Outcomes Framework</code>와 <code class="language-plaintext highlighter-rouge">Structural Causal Model(SCM)</code>의 개괄을 살펴보려 합니다. 이번 포스트도 역시나 인과추론을 처음 접하는 필자가 <a href="https://www.youtube.com/channel/UCkEHnPq2T8Vpafk3p-Rk49A"><code class="language-plaintext highlighter-rouge">인과추론의 데이터과학</code></a> 강의를 듣고 해당 내용을 중심으로 정리합니다. 따라서 자세한 내용은 해당 강의를 보시길 추천드립니다.</p><h1 id="인과추론의-양대산맥">인과추론의 양대산맥</h1><p>인과관계를 알아내기 위한 인간의 고민은 아리스토텔레스 시대까지도 거슬러 올라갈 수 있을 만큼 굉장히 오래된 역사를 가진다고 합니다(<a href="https://namu.wiki/w/%EC%9D%B8%EA%B3%BC">참고</a>). 인간의 사유에 근거한, 철학적인 접근으로 인과관계가 무엇인지 고민했던 것이죠. 현대는 데이터의 시대입니다. 이에 따라, 인간의 사유에만 의존했던 과거의 철학적 접근 방식을 너머, 더욱 시스템적이고 과학적인 방법으로 인과관계를 분석하려는 방식이 개발되었습니다.</p><p><img data-src="/assets/img/2022-05-03-Causal%20Inference%2002/frameworks.png" alt="frameworks" data-proofer-ignore></p><p>위 그림이 바로 그것인데요. 이들은 인과추론의 양대산맥으로, 왼쪽은 Potential Outcomes Framework라는 인과추론 방식이며, 오른쪽은 Structural Causal Model이라는 인과추론 방식입니다. Potential Outcomes Framework는 하버드의 Donald Rubin 교수님이 만든 방법이며, Structural Causal Model은 UCLA의 Judea Pearl 교수님이 개발했다고 합니다. 무엇이 다를까요? 구체적인 방법론의 상세 내용은 추후에 하나씩 다루겠지만, 지금은 간략하게만 짚고 가봅시다.</p><p>Potential Outcomes Framework는 ‘만약 타임머신을 타고 과거로 돌아갔는데 그 원인이 없었더라면 현재 결과는 어땠을까?’라는 관점에서 인과관계를 정의합니다. 제목 그대로 Potential Outcome, 즉, <code class="language-plaintext highlighter-rouge">잠재적 결과</code>를 이용하여 인과관계를 보려는 것이죠. 반면에, Structural Causal Model은 인과관계로 표현할 수 있는 변수들을 <code class="language-plaintext highlighter-rouge">인과그래프</code>로 모델링한 후, 인과관계를 분석해보려는 시도입니다.</p><p>이 두 방법 중 어느 방법이 특별히 더 우수하다거나 상호배타적인 관계라고 할 수는 없습니다. 다만, 결이 다른 접근 방법이라고 보면 좋을 것 같습니다. Potential Outcomes Framework의 경우, 해당 방법론의 초석을 다진 연구자들이 최근 노벨 경제학상을 받았다고 합니다. 한편, Structural Causal Model을 개척한 Judea Pearl 교수님은 컴퓨터과학 분야에서 가장 권위 있는 상인 Turing Award를 수상했다고 합니다. 이러한 단편적인 예만 보아도 두 방식의 차이가 있는데, 전자는 사회과학 분야를 바탕으로 발전되어 왔으며, 후자는 컴퓨터과학 분야를 바탕으로 발전되었다고 합니다. 중요한 것은, 결이 다른 두 방법론을 잘 이해하고, 우리가 풀고자 하는 문제에 더 적합한 방법론이 무엇인지 결정하여 잘 활용하는 데 있습니다.</p><h1 id="훑어보는-potential-outcomes-framework">훑어보는 Potential Outcomes Framework</h1><p>앞서, Potential Outcomes Framework는 잠재적 결과를 이용하여 인과관계를 분석한다고 했습니다. 이 말에 대해서 조금 더 들여다보도록 하죠.</p><p><img data-src="/assets/img/2022-05-03-Causal Inference 02/counterfactual_controlgroup.png" alt="counterfactual_controlgroup" data-proofer-ignore></p><h2 id="counterfactual과-control-group"><span class="mr-2">Counterfactual과 Control Group</span><a href="#counterfactual과-control-group" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>‘독서가 성적에 미치는 영향’을 심슨가족 캐릭터로 예를 들어봅시다. 위 그림의 왼쪽을 보았을 때, 책을 읽고 있는 리사(여자)가 진짜 책을 읽었기 때문에 성적이 올랐는지를 Potential Outcomes Framework 관점에서 분석하려 합니다. 그러면 리사가 <code class="language-plaintext highlighter-rouge">(1)책을 읽은 후 받은 성적</code>과 <code class="language-plaintext highlighter-rouge">(2)타임머신을 타고 책을 읽기 전으로 돌아간 후, 이번에는 책을 읽지 않아본 상태로 받은 성적</code>을 비교해보아야 합니다. 이때 전자를 <code class="language-plaintext highlighter-rouge">(1)실제 결과</code>라고 하고, 후자를 <code class="language-plaintext highlighter-rouge">(2)잠재적 결과(Potential Outcome)</code>라 하며, 실제 결과와 잠재적 결과의 차이인 <code class="language-plaintext highlighter-rouge">(1)-(2)</code>를 <code class="language-plaintext highlighter-rouge">처방(Treatment)의 인과적 효과(Causal Effect)</code>라고 합니다. 또한 (2)잠재적 결과를 실제 (1)이라는 사실과 반대되는 사실이라 하여 <code class="language-plaintext highlighter-rouge">반사실(Counterfactual)</code>이라고 부릅니다. 아래와 같이 표현할 수 있습니다.</p><blockquote><p><strong>Causal effect of the treatment</strong><br /> = (Actual outcome for treated if treated) - (Potential outcome for treated if not treated (i.e., Counterfactual))</p></blockquote><p>사실 여기에는 문제가 있습니다. 현실 세계에서는 타임머신이 존재하지 않기 때문에 실제로는 잠재적 결과를 관측할 수 없다는 점입니다. 이러한 문제를 <code class="language-plaintext highlighter-rouge">Fundamental Problem of Causal Inference</code>라고 부릅니다.</p><p>이처럼 우리는 현실에서 반사실에 대한 잠재적 결과를 관측할 수 없기 때문에 대안을 찾아야 합니다. 그 대안은 나와 다른 행동을 한 집단인 <code class="language-plaintext highlighter-rouge">Control Group</code>을 관측해보는 것입니다. 위 그림의 오른쪽으로 예를 들어보자면, 리사(여자)가 진짜 책을 읽었기 때문에 성적이 올랐는지를 분석하기 위해서 책을 읽지 않은 다른 사람, 즉 바트(남자)와 비교하는 것입니다. 즉, 바트가 Control Group이 되는 것이죠. Control Group인 바트가 책을 읽지 않고 받는 성적은 관측 가능하기 때문에, 책을 읽은 리사의 성적과 비교 가능할 것입니다. 아래와 같이 표현할 수 있습니다.</p><blockquote><p><strong>Observed effect of the treatment</strong><br /> = (Actual outcome for treated if treated) - (Actual outcome for untreated if not treated (i.e., Control Group))</p></blockquote><h2 id="선택편향selection-bias"><span class="mr-2">선택편향(Selection Bias)</span><a href="#선택편향selection-bias" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>그렇다면, 실제 결과와 ‘Counterfactual의 잠재적 결과’가 아닌, ‘Control Group의 실제 결과’를 비교하는 방식이 동일한 인과적 효과를 낼 것이라고 확신할 수 있을까요? 분명히 차이가 있을 수밖에 없을 것입니다. 예를 들어, 리사가 책을 읽었기 때문에 책을 읽지 않은 Control Group인 바트보다 성적이 잘 나온 것인지, 아니면 애초에 리사가 너무나 똑똑해서 책을 읽지 않았어도 성적이 잘 나왔을 것인지 명확하게 말하기 어렵습니다. 이처럼, 나와 ‘나의 반사실에 대한 잠재적 결과’가 아닌 ‘남의 결과’를 비교하면서 발생하는 차이를 <code class="language-plaintext highlighter-rouge">선택편향(Selection Bias)</code>라고 합니다. 아래와 같이 분해하여 표현할 수 있습니다.</p><blockquote><p><strong>Observed effect of the treatment (decomposition)</strong><br /><br /> = (Outcome for treated if treated) - (Outcome for untreated if not treated (i.e., Control Group))<br /><br /> = (Outcome for treated if treated) <br /> - (Outcome for treated if not treated) + (Outcome for treated if not treated) <strong># Zero Some</strong><br /> - (Outcome for untreated if not treated) <br /><br /> = (Outcome for treated if treated) - (Outcome for treated if not treated) <strong># Causal Effect</strong><br /> + (Outcome for treated if not treated) - (Outcome for untreated if not treated) <strong># Selection Bias</strong><br /><br /> = Causal Effect + Selection Bias</p></blockquote><h2 id="비교할-수-있는-control-group-찾기-ceteris-paribus"><span class="mr-2">비교할 수 있는 Control Group 찾기 (Ceteris Paribus)</span><a href="#비교할-수-있는-control-group-찾기-ceteris-paribus" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>앞서, 관측 가능한 Control Group을 이용하여 비교하면 선택편향이 발생하기 때문에 정확한 인과추론이 어려워진다는 것을 살펴보았습니다. 그럼 선택편향 자체를 없앨 수만 있다면 관측 가능한 Control Group을 이용하면서도 인과추론이 가능해지지 않을까요?</p><p>만약, Control Group이 반사실 집단, 즉, Counterfactual과 동일하다면, 선택편향은 사라질 것입니다. 즉, Counterfactual과 최대한 비슷하게 Control Group을 구성하면, 선택편향이 최소화되어 Control Group을 Counterfactual를 대신하여 비교할 수 있다는 것입니다. 이는 Control Group을 구성할 때, 타임머신을 타고 과거로 돌아가서 원인이 되는 일을 내가 실제로 행하였는지<em>(즉, 처방을 받았는지(treated))</em> 여부만 제외하고 Counterfactual과 모든 조건을 동일하게 설정하면 됩니다. 이처럼 나머지 모든 조건을 동일하게 둔다는 설정을 라틴어로 <code class="language-plaintext highlighter-rouge">Ceteris Paribus</code>라고 합니다. 이와 같이 Potential Outcomes Framework는 Counterfactual과 가장 가까운 Control Group을 찾아낼 수 있도록 연구 디자인을 고안하는 접근 방식을 취합니다.</p><p>하지만 Ceteris Paribus를 만족하는 설정으로 Control Group을 구성하는 것 또한 쉬운 일이 아닙니다. 왜냐하면, 현실 세계에서는 우리가 관측하고자 하는 Control Group을 구성하는 <code class="language-plaintext highlighter-rouge">Selection Process</code>를 완벽하게 통제하기 어렵기 때문입니다.</p><p><img data-src="/assets/img/2022-05-03-Causal Inference 02/selection_process.png" alt="selection_process" data-proofer-ignore></p><p>위 그림은 보조금을 받은 집단과 보조금을 받지 못한 Control Group을 구성하는 과정을 나타내는 예입니다. 주목할 것은, Control Group으로 구성된 보조금을 받지 못한 집단의 경우, 보조금 자체를 신청하지 않은 사람도 있겠으나, 어떤 이유에서든지 보조금을 지원했는데 탈락하여 받지 못한 사람도 있을 수 있다는 것입니다. 이 경우, 같은 Control Group에 속해있는 사람이라 해도 그 성격이 매우 다를 것이고, 결과적으로 이렇게 구성된 Control Group으로는 Cetris Paribus를 만족하기 어려울 것입니다. 결과적으로 인과관계에 대한 추론은 더욱더 어려워질 것입니다.</p><p>한편, Selection Process를 완전하게 통제할 수 있는 이상적인 경우가 있기는 합니다. 바로 Control Group을 구성하는 방식을 동전 던지기로 결정하는 등 완전히 무작위로 정하면 되는데요. 이 방법은 머릿속에서 상상하기로 가장 이상적으로 Counterfactual과 가까운 Control Group을 구성할 수 있겠지만, 윤리적 문제나 실현 불가능성 등의 이유로 현실에서 활용하기 어렵습니다. 예를 들어, 담배와 폐암의 인과관계를 보기 위해 Control Group을 무작위로 뽑은 후 흡연을 강제할 수는 없겠죠.</p><p>정리하자면, Potential Outcomes Framework는 무작위로 Control Group을 구성하여 비교하면 인과관계를 쉽게 도출할 수 있겠지만, 현실적으로 어려우니, 이를 대신할 수 있는 적절한 연구 디자인을 고민함으로써 인과관계를 추론한다고 이해하면 좋을 것 같습니다. 이에 대한 방법론도 무척 많지만, 기회가 되면 다음 포스트에서 다루겠습니다.</p><h1 id="훑어보는-structural-causal-modelscm">훑어보는 Structural Causal Model(SCM)</h1><p>Causal Inference의 또다른 양대산맥으로 볼 수 있는 Sturctural Causal Model 또한 간략하게 훑어보겠습니다. Structural Causal Model은 기본적으로 <code class="language-plaintext highlighter-rouge">Bayesian Network</code>를 활용하여 인과관계를 표현하고 추론하는 접근방식입니다.</p><p>Bayesian Network란, 랜덤 변수의 집합과 <code class="language-plaintext highlighter-rouge">유향 비순환 그래프(Directed Acyclic Graph, DAG)</code>를 통하여 그 집합을 조건부 독립으로 표현하는 확률 그래픽 모델입니다. 말이 어렵네요. 자세한 내용은 추후에 다루도록 하고, 간단하게 그래프의 노드는 변수를, 엣지(화살표)는 인과관계를 표현한다고 생각하고 넘어갑시다.</p><h2 id="causal-graph"><span class="mr-2">Causal Graph</span><a href="#causal-graph" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><img data-src="/assets/img/2022-05-03-Causal Inference 02/graphs.png" alt="graphs" data-proofer-ignore></p><p>위 그림은 유향 비순환 그래프로 인과관계를 표현한 <code class="language-plaintext highlighter-rouge">Causal Graph</code>의 종류입니다. 각각을 해석하면 다음과 같습니다.</p><ul><li><code class="language-plaintext highlighter-rouge">(Direct) Causal Effect</code><ul><li>원인 변수 $D$가 결과 변수 $Y$에게 직접적으로 영향을 주는 경우입니다.</ul><li><code class="language-plaintext highlighter-rouge">Mediator (Chain)</code><ul><li>원인 변수 $D$가 어떠한 중재 변수 $X$를 통하여 결과 변수 $Y$에게 간접적으로 영향을 주는 경우입니다.</ul><li><code class="language-plaintext highlighter-rouge">Confounder (Fork)</code><ul><li>변수 $D$와 변수 $Y$에 영향을 주는 공통 변수(Common Cause) $X$가 존재하는 경우입니다. 이때 $X$는 <code class="language-plaintext highlighter-rouge">Confounder(교란요인)</code>이라고 부르기도 합니다.<li>예시는 다음과 같습니다.<ul><li>($X$ -&gt; $D$ 예시) 술을 마셔서 신발을 신고 잠을 잤다.<li>($X$ -&gt; $Y$ 예시) 술을 마셔서 다음 날 머리가 아프다.</ul></ul><li><code class="language-plaintext highlighter-rouge">Collider (Immorality)</code><ul><li>변수 $D$에도 영향을 받고 변수 $Y$에도 영향을 받는 공통의 결과 변수 $X$가 존재하는 경우입니다.<li>예시는 다음과 같습니다.<ul><li>($D$ -&gt; $X$ 예시) 야간 교대근무를 하면 너무 졸리다.<li>($Y$ -&gt; $X$ 예시) 수면 무호흡증 때문에 잘 못 자면 너무 졸리다.</ul></ul></ul><p>아래의 그림은 위와 같이 표현될 수 있는 Causal Graph에서 어떻게 연관성(Association)을 해석할 수 있는지 보여줍니다.</p><p><img data-src="/assets/img/2022-05-03-Causal Inference 02/graph_ex.png" alt="graph_ex" data-proofer-ignore></p><p>먼저, $B$ -&gt; $A$ -&gt; $X$를 보면, $B$노드는 원인이 되어 $A$노드를 거쳐서 $X$노드의 결과로 작용됩니다. 한편, $B$ -&gt; $Z$ -&gt; $Y$를 보면, $B$노드는 원인이 되어 $Z$노드를 거쳐서 $Y$노드의 결과로 작용됩니다. 즉, $X$노드와 $Y$노드 모두 간접적으로 $B$노드의 정보를 공유하고 있습니다. 즉, 두 노드 간 <code class="language-plaintext highlighter-rouge">Causal Association</code>이 있다고 볼 수 있습니다.</p><p>이번에는 $X$노드를 원인 변수로, $Y$노드를 결과 변수로 간주하고 살펴보겠습니다. 이 경우는 $X$ -&gt; $W$ -&gt; $Y$ 경로만이 간접적으로나마 Causal Association을 가집니다. 그 이외의 경로들은 인과성이 없으므로, <code class="language-plaintext highlighter-rouge">Noncausal Association</code>이라 할 수 있는데, 이러한 경로들을 <code class="language-plaintext highlighter-rouge">Backdoor Path</code>라고 하며, 아래와 같습니다.</p><p><img data-src="/assets/img/2022-05-03-Causal Inference 02/graph_backdoor_ex.png" alt="graph_backdoor_ex" data-proofer-ignore></p><p>정리하자면, Structural Causal Model을 활용한 인과추론 방법은 위와 같은 Noncausal Association을 만드는 모든 Backdoor Path들을 차단함으로써 인과적인 효과를 구하는 것을 목적으로 합니다.</p><h2 id="d-separation과-d-connection"><span class="mr-2">d-separation과 d-connection</span><a href="#d-separation과-d-connection" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>실제로 Causal Graph는 매우 복잡합니다. 그 안에는 수많은 Mediator와 Confounder, 그리고 Collider가 복잡하게 존재할 것입니다. 복잡한 그래프 내에서 임의의 두 노드가 의존성을 가지고 있는지 혹은 분리되어 있는지를 확인할 수 있는데, 이러한 일종의 규칙을 <code class="language-plaintext highlighter-rouge">d-separation</code>이라고 합니다. 여기서의 d는 ‘방향성(direction)’을 의미합니다. 그림을 보면서 이해해보겠습니다.</p><p><img data-src="/assets/img/2022-05-03-Causal Inference 02/d_sep.png" alt="d_sep" data-proofer-ignore></p><p>위 그래프에서 ‘특정 노드로 가는 경로를 차단하는 행위’를 <code class="language-plaintext highlighter-rouge">Conditioning</code>이라고 표현합니다. 원래 그래프에서는 노드 $X$에서 $Y$는 연결되어 있습니다. 즉, <code class="language-plaintext highlighter-rouge">d-connected</code>되어 있죠. 그런데, 만약 노드 $A$를 Conditioning 한다고 하면, $A$노드로 향하는 경로가 끊겨버립니다. 이로 인해 $X$노드에서 $Y$노드로 가는 경로는 차단되는데, 이는 $X$와 $Y$ 사이의 정보 흐름이 차단되어 인과적 연관성마저 사라지게 됩니다. 즉, <code class="language-plaintext highlighter-rouge">d-separated</code> 되는 것입니다. 반면, 원래 그래프에서 노드 $C$로 가는 경로를 Conditioning하여 차단한다 하더라도, $X$노드에서 $Y$노드는 연결되어 있습니다. 즉, d-connection 되어 있는 것입니다.</p><h2 id="do-operator"><span class="mr-2">do-operator</span><a href="#do-operator" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Structural Causal Model은 이처럼 복잡한 그래프에서 Noncausal Association을 만드는 Backdoor Path들을 Conditioning 함으로써 인과관계 효과를 분석하는 방식입니다. 그런데 그래프가 매우 복잡한 상황에서 이러한 행위들을 일일이 손으로 한땀한땀 할 수는 없겠죠. Structural Causal Model을 개척한 Judea Pearl 교수님은 이 과정을 체계적으로 수행하고 분석하기 위해서 <code class="language-plaintext highlighter-rouge">do-operator</code>를 제안합니다.</p><p>do-operator는 Confounder로 인해 Backdoor Path가 열려있는 상황에서 Backdoor Path를 차단하는 방법으로, 원인 변수에 영향을 주는 모든 요인을 배제하는 상태로 만들어주는 연산입니다. 복잡합니다. 그런데, 개념만 이해하자면, 앞서 Potential Outcomes Framework에서의 Counterfactual처럼 실제로 구할 수 있는 개념이라기보다는 추상적인 개념입니다. 즉, 물리적으로 실제 그래프에서 원인 변수에 영향을 주는 요인을 차단한다기 보다는 상상속에서 이루어진다고 생각하면 좋을 것 같네요.</p><p><img data-src="/assets/img/2022-05-03-Causal Inference 02/do_op.png" alt="do_op" data-proofer-ignore></p><p>위의 그림을 살펴보며 이해해봅시다. $T$노드가 $Y$노드와 인과적 연관성이 있는지 분석하고자 하는데, 왼쪽의 방식은 빨간 점선으로 표현되는 Backdoor Path가 열려있어서 인과관계 분석이 어렵습니다. 오른쪽과 같이 do-operator를 적용하여 상상속에서 Backdoor Path를 차단한다면, $T$노드와 $Y$노드의 인과적 연관성을 쉽게(?) 구할 수 있어보입니다.</p><p>그런데 do-operator가 추상적 개념인데 이것을 도대체 어떻게 계산할 수 있다는 것일까요? do-operator로 표현한 그래프는 실제로 계산이 가능한 조건부확률의 형태로 변환하여 계산할 수 있는데, Judea Pearl 교수님은 이를 가능하도록 하는 일종의 수학적 규칙 집합인 <code class="language-plaintext highlighter-rouge">do-calculus</code>를 제안했습니다. 이러한 일련의 과정을 <code class="language-plaintext highlighter-rouge">Identification</code>이라고 합니다. 이때, Identification이 적용되어 변환이 되는 경우도 있겠으나, 불가능한 경우도 있으며, 이러한 Non-identifiable한 경우는 주어진 그래프로 인과적 효과를 구할 수 없음을 의미합니다.</p><p>정리하자면, Structural Causal Model은 어떠한 현상에 대해서 변수 간의 관계 등을 그래프 형태로 표현하는 방법을 제시하였고, do-operator를 통해서 인과적인 효과를 추론하고자 하는 접근 방법이라고 이해할 수 있겠습니다.</p><h1 id="정리하며">정리하며</h1><p>이번 포스트에서는 인과추론의 양대산맥인 Potential Outcomes Framework와 Structural Causal Model을 간략하게나마 훑어보았습니다. 내용이 정말로 방대하고 어려워서 많은 공부의 필요성을 느낍니다. 본 포스트의 주 참고 자료인 <a href="https://www.youtube.com/channel/UCkEHnPq2T8Vpafk3p-Rk49A"><code class="language-plaintext highlighter-rouge">인과추론의 데이터과학</code></a>이 큰 도움이 된 것 같습니다. 이후에는 본 포스트에서 다룬 주요 내용들을 더욱 자세히 살펴본 후 정리하겠습니다.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/causal-inference/'>Causal Inference</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/causal-inference/" class="post-tag no-text-decoration" >Causal Inference</a> <a href="/tags/root-cause-analysis/" class="post-tag no-text-decoration" >Root Cause Analysis</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=%EA%B3%B5%EB%B6%80%ED%95%98%EB%A9%B0+%EC%A0%95%EB%A6%AC%ED%95%98%EB%8A%94+%EC%9D%B8%EA%B3%BC%EC%B6%94%EB%A1%A0+02+-+Simon%27s+Research+Center&url=https%3A%2F%2Fzerojsh00.github.io%2Fposts%2FCausal-Inference-02%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=%EA%B3%B5%EB%B6%80%ED%95%98%EB%A9%B0+%EC%A0%95%EB%A6%AC%ED%95%98%EB%8A%94+%EC%9D%B8%EA%B3%BC%EC%B6%94%EB%A1%A0+02+-+Simon%27s+Research+Center&u=https%3A%2F%2Fzerojsh00.github.io%2Fposts%2FCausal-Inference-02%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fzerojsh00.github.io%2Fposts%2FCausal-Inference-02%2F&text=%EA%B3%B5%EB%B6%80%ED%95%98%EB%A9%B0+%EC%A0%95%EB%A6%AC%ED%95%98%EB%8A%94+%EC%9D%B8%EA%B3%BC%EC%B6%94%EB%A1%A0+02+-+Simon%27s+Research+Center" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div><script src="https://utteranc.es/client.js" repo="zerojsh00/zerojsh00.github.io" issue-term="pathname" theme="github-light" crossorigin="anonymous" async> </script></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Network-Policy/">(K8S) 네트워크 정책(Network Policy) 기초 개념</a><li><a href="/posts/CNI-Weave/">(K8S) CNI Weave의 기초 개념</a><li><a href="/posts/Container-Networking-Interface/">(K8S) 네트워크 기초 정리 - CNI</a><li><a href="/posts/Storage-in-Docker/">(K8S) 도커의 스토리지(Storage in Docker)</a><li><a href="/posts/Security-Context/">(K8S) Security Context</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/k8s/">K8S</a> <a class="post-tag" href="/tags/kubernetes/">Kubernetes</a> <a class="post-tag" href="/tags/paper-review/">Paper Review</a> <a class="post-tag" href="/tags/security/">Security</a> <a class="post-tag" href="/tags/network/">Network</a> <a class="post-tag" href="/tags/speech-ai/">Speech AI</a> <a class="post-tag" href="/tags/scheduling/">Scheduling</a> <a class="post-tag" href="/tags/nlp/">NLP</a> <a class="post-tag" href="/tags/storage/">Storage</a> <a class="post-tag" href="/tags/asr/">ASR</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Causal-Inference-01/"><div class="card-body"> <em class="timeago small" data-ts="1651417200" > 2022-05-02 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>공부하며 정리하는 인과추론 01</h3><div class="text-muted small"><p> 이 포스트는 개인적으로 공부한 내용을 정리하고 필요한 분들에게 지식을 공유하기 위해 작성되었습니다. 지적하실 내용이 있다면, 언제든 댓글 또는 메일로 알려주시기를 바랍니다. 본 포스트의 상당 내용은 인과추론의 데이터과학 강의를 정리한 것임을 밝힙니다. 인과추론을 통해 달성하고자 하는 것 IT 운영 관리에서의 근본원인분석 과거에는 소프트웨어를...</p></div></div></a></div><div class="card"> <a href="/posts/Causal-Discovery-and-PC-algorithm/"><div class="card-body"> <em class="timeago small" data-ts="1652281200" > 2022-05-12 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Causal Discovery와 PC 알고리즘</h3><div class="text-muted small"><p> 이 포스트는 개인적으로 공부한 내용을 정리하고 필요한 분들에게 지식을 공유하기 위해 작성되었습니다. 지적하실 내용이 있다면, 언제든 댓글 또는 메일로 알려주시기를 바랍니다. 본 포스트의 상당 내용은 인과추론의 데이터과학 강의를 정리한 것임을 밝힙니다. 00. 들어가며 필자가 인과추론을 공부하기 시작한 이유는 클라우드 인프라 자원의 장애 발생...</p></div></div></a></div><div class="card"> <a href="/posts/Causal-Bayesian-Network-01/"><div class="card-body"> <em class="timeago small" data-ts="1651935600" > 2022-05-08 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>(인과추론의 데이터과학) Bayesian Network의 개념</h3><div class="text-muted small"><p> 이 포스트는 개인적으로 공부한 내용을 정리하고 필요한 분들에게 지식을 공유하기 위해 작성되었습니다. 지적하실 내용이 있다면, 언제든 댓글 또는 메일로 알려주시기를 바랍니다. 본 포스트 내용은 인과추론의 데이터과학, 베이지안 네트워크 (Bayesian Network) 강의를 정리한 것임을 밝힙니다. Probability ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Causal-Inference-01/" class="btn btn-outline-primary" prompt="Older"><p>공부하며 정리하는 인과추론 01</p></a> <a href="/posts/Causal-Bayesian-Network-01/" class="btn btn-outline-primary" prompt="Newer"><p>(인과추론의 데이터과학) Bayesian Network의 개념</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/zerojsh00">Sanghyeon</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/k8s/">K8S</a> <a class="post-tag" href="/tags/kubernetes/">Kubernetes</a> <a class="post-tag" href="/tags/paper-review/">Paper Review</a> <a class="post-tag" href="/tags/security/">Security</a> <a class="post-tag" href="/tags/network/">Network</a> <a class="post-tag" href="/tags/speech-ai/">Speech AI</a> <a class="post-tag" href="/tags/scheduling/">Scheduling</a> <a class="post-tag" href="/tags/nlp/">NLP</a> <a class="post-tag" href="/tags/storage/">Storage</a> <a class="post-tag" href="/tags/asr/">ASR</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/ko.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
