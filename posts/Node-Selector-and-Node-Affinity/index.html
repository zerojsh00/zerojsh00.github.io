<!DOCTYPE html><html lang="ko" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="(K8S) 노드 셀렉터와 노드 어피니티" /><meta name="author" content="simon sanghyeon" /><meta property="og:locale" content="ko" /><meta name="description" content="이 글은 Mumshad Mannambeth가 강의한 Udemy의 Certified Kubernetes Administrator (CKA) with Practice Tests 강의 커리큘럼을 토대로 공부한 내용을 정리하였음을 밝힙니다." /><meta property="og:description" content="이 글은 Mumshad Mannambeth가 강의한 Udemy의 Certified Kubernetes Administrator (CKA) with Practice Tests 강의 커리큘럼을 토대로 공부한 내용을 정리하였음을 밝힙니다." /><link rel="canonical" href="https://zerojsh00.github.io/posts/Node-Selector-and-Node-Affinity/" /><meta property="og:url" content="https://zerojsh00.github.io/posts/Node-Selector-and-Node-Affinity/" /><meta property="og:site_name" content="Simon’s Research Center" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-08-15T00:00:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="(K8S) 노드 셀렉터와 노드 어피니티" /><meta name="twitter:site" content="@" /><meta name="twitter:creator" content="@simon sanghyeon" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"simon sanghyeon"},"dateModified":"2022-09-23T01:07:02+09:00","datePublished":"2022-08-15T00:00:00+09:00","description":"이 글은 Mumshad Mannambeth가 강의한 Udemy의 Certified Kubernetes Administrator (CKA) with Practice Tests 강의 커리큘럼을 토대로 공부한 내용을 정리하였음을 밝힙니다.","headline":"(K8S) 노드 셀렉터와 노드 어피니티","mainEntityOfPage":{"@type":"WebPage","@id":"https://zerojsh00.github.io/posts/Node-Selector-and-Node-Affinity/"},"url":"https://zerojsh00.github.io/posts/Node-Selector-and-Node-Affinity/"}</script><title>(K8S) 노드 셀렉터와 노드 어피니티 | Simon's Research Center</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Simon's Research Center"><meta name="application-name" content="Simon's Research Center"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><meta name="google-site-verification" content="J_a4XJ2oefe52p6EYvjTFdh9LW5Yc5RyGg1HpQOjWaA" /><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/avatar.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Simon's Research Center</a></div><div class="site-subtitle font-italic">성장하는 연구원의 공책</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/zerojsh00" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['zerojsh00','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>(K8S) 노드 셀렉터와 노드 어피니티</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>(K8S) 노드 셀렉터와 노드 어피니티</h1><div class="post-meta text-muted"><div> By <em> Sanghyeon </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1660489200" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-08-15 </em> </span> <span> Updated <em class="timeago" data-ts="1663862822" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-09-23 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2190 words"> <em>12 min</em> read</span></div></div></div><div class="post-content"><p>이 글은 Mumshad Mannambeth가 강의한 Udemy의 Certified Kubernetes Administrator (CKA) with Practice Tests 강의 커리큘럼을 토대로 공부한 내용을 정리하였음을 밝힙니다.</p><hr /><p>이번 글에서는 파드를 노드에 배치하는 방법으로 <code class="language-plaintext highlighter-rouge">노드 셀렉터(nodeSelector)</code>와 <code class="language-plaintext highlighter-rouge">노드 어피니티(Node Affinity)</code>를 정리한다. nodeName을 이용하는 <a href="https://zerojsh00.github.io/posts/K8S_Scheduling-manual/">매뉴얼 스케쥴링</a> 및 <a href="https://zerojsh00.github.io/posts/K8S_Taints-and-Tolerations/">테인트와 톨러레이션</a>을 함께 참고하면 좋겠다.</p><h1 id="파드-배치의-필요성">파드 배치의 필요성</h1><p><img data-src="/assets/img/2022-08-15-Node Selector and Node Affinity/fig01.png" alt="fig01" data-proofer-ignore></p><p>위와 같이 클러스터 내에서 노드들의 리소스는 각각 다를 수 있다. 예를 들어, 어떤 노드는 다른 노드보다 더욱 고성능의 하드웨어 리소스를 보유할 수 있는 것이다. 이러한 상황에서 default 세팅으로 파드를 배치하면 다음과 같은 문제가 발생하게 된다.</p><p><img data-src="/assets/img/2022-08-15-Node Selector and Node Affinity/fig02.png" alt="fig02" data-proofer-ignore></p><p>즉, 파드B와 같이 많은 하드웨어 리소스를 소요하는 파드가 노드02와 같이 저성능 노드에 배치되어 파드를 실행하기 위한 하드웨어 자원이 부족해지는 현상이 발생하는 것이다.</p><p>이외에도 하드웨어의 리소스를 고려하여 특정 파드를 특정 노드에서 실행되도록 해야 하는 상황은 다양하게 있을 수 있다. 예를 들면, 어떤 파드는 반드시 SSD에 연결된 노드에 배포해야 하는 경우가 있다. 이러한 경우에 어떻게 특정 파드를 특정 노드에 배포할 수 있는지 살펴보자.</p><hr /><h1 id="노드-셀렉터nodeselector">노드 셀렉터(nodeSelector)</h1><p><code class="language-plaintext highlighter-rouge">노드 셀렉터(nodeSelector)</code>는 파드가 특정 노드에서 실행되도록 하는 가장 쉬운 방법 중 하나로, <strong>nodeSelector는 파드 정의 YAML 파일과 노드에서 사용되는 일종의 label</strong>이다.</p><h2 id="사용법-step-01--파드-정의-yaml-파일에-nodeselector-레이블을-설정함"><span class="mr-2">사용법 step 01 : 파드 정의 YAML 파일에 nodeSelector 레이블을 설정함</span><a href="#사용법-step-01--파드-정의-yaml-파일에-nodeselector-레이블을-설정함" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-yaml highlighter-rouge"><div class="code-header"> <span data-label-text="YAML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="c1"># pod-definition.yaml</span>

<span class="na">kind</span><span class="pi">:</span> <span class="s">Pod</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">myapp-pod</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">containers</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">data-processor</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">data-processor</span>

  <span class="na">nodeSelector</span><span class="pi">:</span> <span class="c1"># 이 부분을 통해서 특정 노드에서만 파드가 실행되도록 한다.</span>
    <span class="na">size</span><span class="pi">:</span> <span class="s">Large</span>
    <span class="c1"># 사실, 이 size: Large는 노드에 부여되는 '레이블'이다.</span>
    <span class="c1"># 스케줄러는 size: Large라고 assign된 레이블이 match되는 노드에 이 파드를 배치한다.</span>
    <span class="c1"># 따라서 이 파드를 배치하기 전에 노드에 size: Large라는 레이블이 먼저 부여되어 있어야 한다.</span>
</pre></table></code></div></div><h2 id="사용법-step-02--파드가-실행될-노드에-동일하게-레이블을-설정함"><span class="mr-2">사용법 step 02 : 파드가 실행될 노드에 동일하게 레이블을 설정함</span><a href="#사용법-step-02--파드가-실행될-노드에-동일하게-레이블을-설정함" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>파드에 설정된 nodeSelector는 단지 레이블일 뿐이기 때문에, 노드에도 레이블을 달아주어야 한다. 노드에 있는 레이블과 일치하는 경우에 이 파드를 해당 노드에 배치할 수 있다.</p><p><code class="language-plaintext highlighter-rouge">kubectl label nodes &lt;노드 이름&gt; &lt;레이블-키 값&gt;=&lt;레이블-밸류 값&gt;</code>의 형태로 노드에 레이블을 달 수 있다. 예를 들면, <code class="language-plaintext highlighter-rouge">kubectl label nodes node-1 size=Large</code>처럼 말이다.</p><p>이후 <code class="language-plaintext highlighter-rouge">kubectl create -f pod-definition.yaml</code> 명령어를 통해 파드를 생성하면, 자동으로 레이블이 matching되는 노드에서 파드가 실행된다.</p><h2 id="노드-셀렉터의-문제점"><span class="mr-2">노드 셀렉터의 문제점</span><a href="#노드-셀렉터의-문제점" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>노드 셀렉터를 이용하는 것은 위 예제에서 살펴보았듯 <code class="language-plaintext highlighter-rouge">size: Large</code>와 같이 단 하나의 레이블만 사용할 수 있다. 만약, 더 복잡한 조건으로 노드를 선택해야 한다면 어떨까? 예를 들어, <code class="language-plaintext highlighter-rouge">size: 크거나 중간</code>과 같은 복잡한 조건이 들어가는 경우 말이다. 이땐 nodeSelector 레이블만으로 노드를 선택할 수는 없다. 즉, 노드 어피니티가 필요하다.</p><hr /><h1 id="노드-어피니티node-affinity">노드 어피니티(Node Affinity)</h1><p><code class="language-plaintext highlighter-rouge">노드 어피니티(Node Affinity)</code>는 앞서 살펴보았던 노드 셀렉터와 유사하게, 파드가 특정 노드에서만 실행될 수 있도록 설정하는 방법이다. 하지만 <strong>노드 어피니티는 nodeSelector 레이블과는 달리, 레이블 선택에 있어서 ‘or’ 조건이라든지 ‘not’ 조건과 같이 복잡한 조건도 처리</strong>할 수 있다.</p><h2 id="사용법"><span class="mr-2">사용법</span><a href="#사용법" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-yaml highlighter-rouge"><div class="code-header"> <span data-label-text="YAML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="c1"># pod-definition.yaml</span>

<span class="na">kind</span><span class="pi">:</span> <span class="s">Pod</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">myapp-pod</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">containers</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">data-processor</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">data-processor</span>

  <span class="c1"># nodeSelector   ... 노드 셀렉터와의 차이점</span>
  <span class="c1"># - size: Large   ... 노드 셀렉터와의 차이점</span>

  <span class="na">affinity</span><span class="pi">:</span>
    <span class="na">nodeAffinity</span><span class="pi">:</span>
      <span class="na">requiredDuringSchedulingIgnoredDuringExecution</span><span class="pi">:</span> <span class="c1"># 노드 어피니티의 속성</span>
      <span class="pi">-</span> <span class="na">matchExpressions</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">key</span><span class="pi">:</span> <span class="s">size</span>
          <span class="na">operator</span><span class="pi">:</span> <span class="s">In</span> <span class="c1"># NotIn, Exsists 등도 가능</span>
          <span class="na">values</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="s">Large</span> <span class="c1"># 추가적으로 다양한 밸류값 가능</span>
          <span class="pi">-</span> <span class="s">Medium</span>
          <span class="pi">-</span> <span class="s">...</span>
</pre></table></code></div></div><p>노드 어피니티의 특징을 관찰해보자. 파드가 특정 노드에서 실행되도록 한다는 점에서 개념적으로는 노드 셀렉터와 동일한 기능이지만, 노드 셀렉터보다 훨씬 복잡하게 정의되어야 한다.</p><p>복잡하지만, 노드 어피니티는 <code class="language-plaintext highlighter-rouge">operator</code> 부분을 다양하게 설정하여 복잡한 조건들을 반영하면서 노드를 선택할 수 있게 한다. 심지어 values 값을 모를 때는 Exists라는 operator를 사용하고 values를 생략할 수도 있다. 참고로, <code class="language-plaintext highlighter-rouge">values</code> 값에는 더욱 다양하게 값들을 여러 개를 나열할 수 있다.</p><h2 id="노드-어피니티의-속성--matchexpression에-대응되는-노드가-없는-경우"><span class="mr-2">노드 어피니티의 속성 : matchExpression에 대응되는 노드가 없는 경우</span><a href="#노드-어피니티의-속성--matchexpression에-대응되는-노드가-없는-경우" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>만약, 노드 어피니티를 위해 파드 정의 YAML 파일에서 설정한 <code class="language-plaintext highlighter-rouge">matchExpression</code>에 대응되는 노드가 없다면 어떻게 될까? 또는, 미래에 누군가가 노드의 레이블을 바꾸어버린다면, 위와 같은 설정으로 만들어진 파드는 계속해서 해당 노드에서 실행될까? 이러한 이슈는 <code class="language-plaintext highlighter-rouge">requiredDuringSchedulingIgnoredDuringExecution</code>처럼 긴 속성으로 해결할 수 있다.</p><p>현재 지원되는 노드 어피니티의 속성 값은 아래와 같다.</p><ul><li><span style="background-color: #FFCC4E">required</span><span style="background-color: #D5E05B">DuringScheduling</span><span style="background-color: #B0DFDB">Ignored</span><span style="background-color: #BBB8DC">DuringExecution</span><li><span style="background-color: #81D3EB">preferred</span><span style="background-color: #D5E05B">DuringScheduling</span><span style="background-color: #B0DFDB">Ignored</span><span style="background-color: #BBB8DC">DuringExecution</span></ul><h3 id="duringscheduling"><span class="mr-2">DuringScheduling</span><a href="#duringscheduling" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><span style="background-color: #D5E05B">DuringScheduling</span>이란, <strong>아직 파드가 존재하지 않는 상태</strong>이며, 처음으로 파드가 생성되는 시점을 의미한다.</p><p>속성이 <span style="background-color: #FFCC4E">required</span>로 설정되어 있다면, 파드를 노드에 배치함에 있어 <code class="language-plaintext highlighter-rouge">어피니티 규칙(affinity rule)</code>에 의한 matching이 필수인 경우를 의미한다. 즉, 스케줄러는 파드가 처음 생성될 때 어피니티 규칙에 따라 노드에 배치되도록 지시하는데, 만약 어피니티 규칙에 따라 matching되는 노드가 없으면, 파드는 스케줄링되지 않는다. 이는 파드가 특정 노드에 배치되도록 설정하는 것이 매우 중요한 상황에서 사용된다.</p><p>속성이 <span style="background-color: #81D3EB">preferred</span>로 설정되어 있다면, 파드를 노드에 배치함에 있어 우선적으로 어피니티 규칙을 고려하되, 어피니티 규칙에 matching되는 노드가 없는 경우에는 아무 노드에 배치될 수 있다. 이는 파드가 특정 노드에 배치되도록 설정하는 것이 선호되기는 하지만 필수는 아닌 상황에서 사용된다.</p><h3 id="duringexecution"><span class="mr-2">DuringExecution</span><a href="#duringexecution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><span style="background-color: #BBB8DC">DuringExecution</span>이란, 파드가 이미 만들어져 있고 특정 노드 상에서 실행 중에 있는데, <strong>노드의 레이블이 변경되는 상황과 같이 노드 어피니티에 영향을 주는 변화가 있는 때</strong>를 의미한다. 예를 들어, 실행 중인 파드는 어피니티 규칙에 의해 <code class="language-plaintext highlighter-rouge">size:Large</code>로 레이블된 노드에서 실행되고 있는데, 노드의 레이블이 바뀌면 파드는 계속 실행될 수 있는 것인지를 이 부분에서 설정한다.</p><p>속성이 <span style="background-color: #B0DFDB">Ignored</span>로 설정되어 있기 때문에 노드 어피니티에 영향을 주는 변화가 있어도 파드는 이를 무시하고 계속해서 실행된다.</p><p>(참고로, 현재까지 쿠버네티스에서 지원되는 속성들은 모두 <span style="background-color: #B0DFDB">Ignored</span>이지만, 추후 <code class="language-plaintext highlighter-rouge">Required</code> 등도 지원될 예정이다. <code class="language-plaintext highlighter-rouge">requiredDuringSchedulingRequiredDuringExecution</code>)</p><hr /><h1 id="참고-문헌">참고 문헌</h1><p>[1] <code class="language-plaintext highlighter-rouge">Mumshad Mannambeth의 강의</code> : <a href="https://www.udemy.com/course/certified-kubernetes-administrator-with-practice-tests/">Certified Kubernetes Administrator (CKA) with Practice Tests</a><br /> [2] <code class="language-plaintext highlighter-rouge">시작하세요! 도커/쿠버네티스 (용찬호 지음)</code> : <a href="http://www.yes24.com/Product/Goods/84927385">시작하세요! 도커/쿠버네티스</a><br /> [3] <code class="language-plaintext highlighter-rouge">쿠버네티스 공식 documentation</code> : <a href="https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/#nodename">Assigning Pods to Nodes</a></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/kubernetes/'>Kubernetes</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/kubernetes/" class="post-tag no-text-decoration" >Kubernetes</a> <a href="/tags/k8s/" class="post-tag no-text-decoration" >K8S</a> <a href="/tags/scheduling/" class="post-tag no-text-decoration" >Scheduling</a> <a href="/tags/nodeselector/" class="post-tag no-text-decoration" >NodeSelector</a> <a href="/tags/nodeaffinity/" class="post-tag no-text-decoration" >NodeAffinity</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=%28K8S%29+%EB%85%B8%EB%93%9C+%EC%85%80%EB%A0%89%ED%84%B0%EC%99%80+%EB%85%B8%EB%93%9C+%EC%96%B4%ED%94%BC%EB%8B%88%ED%8B%B0+-+Simon%27s+Research+Center&url=https%3A%2F%2Fzerojsh00.github.io%2Fposts%2FNode-Selector-and-Node-Affinity%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=%28K8S%29+%EB%85%B8%EB%93%9C+%EC%85%80%EB%A0%89%ED%84%B0%EC%99%80+%EB%85%B8%EB%93%9C+%EC%96%B4%ED%94%BC%EB%8B%88%ED%8B%B0+-+Simon%27s+Research+Center&u=https%3A%2F%2Fzerojsh00.github.io%2Fposts%2FNode-Selector-and-Node-Affinity%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fzerojsh00.github.io%2Fposts%2FNode-Selector-and-Node-Affinity%2F&text=%28K8S%29+%EB%85%B8%EB%93%9C+%EC%85%80%EB%A0%89%ED%84%B0%EC%99%80+%EB%85%B8%EB%93%9C+%EC%96%B4%ED%94%BC%EB%8B%88%ED%8B%B0+-+Simon%27s+Research+Center" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div><script src="https://utteranc.es/client.js" repo="zerojsh00/zerojsh00.github.io" issue-term="pathname" theme="github-light" crossorigin="anonymous" async> </script></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Network-Policy/">(K8S) 네트워크 정책(Network Policy) 기초 개념</a><li><a href="/posts/CNI-Weave/">(K8S) CNI Weave의 기초 개념</a><li><a href="/posts/Container-Networking-Interface/">(K8S) 네트워크 기초 정리 - CNI</a><li><a href="/posts/Storage-in-Docker/">(K8S) 도커의 스토리지(Storage in Docker)</a><li><a href="/posts/Security-Context/">(K8S) Security Context</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/k8s/">K8S</a> <a class="post-tag" href="/tags/kubernetes/">Kubernetes</a> <a class="post-tag" href="/tags/paper-review/">Paper Review</a> <a class="post-tag" href="/tags/security/">Security</a> <a class="post-tag" href="/tags/network/">Network</a> <a class="post-tag" href="/tags/speech-ai/">Speech AI</a> <a class="post-tag" href="/tags/scheduling/">Scheduling</a> <a class="post-tag" href="/tags/nlp/">NLP</a> <a class="post-tag" href="/tags/storage/">Storage</a> <a class="post-tag" href="/tags/asr/">ASR</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Taints-and-Tolerations-vs-Node-Affinity/"><div class="card-body"> <em class="timeago small" data-ts="1660575600" > 2022-08-16 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>(K8S) 테인트와 톨러레이션 vs 노드 어피니티</h3><div class="text-muted small"><p> 이 글은 Mumshad Mannambeth가 강의한 Udemy의 Certified Kubernetes Administrator (CKA) with Practice Tests 강의 커리큘럼을 토대로 공부한 내용을 정리하였음을 밝힙니다. 이번 글에서는 파드를 적합한 노드에 배포하기 위해 테인트와 톨러레이션과 노드 어피니티를 조합하여 사용하는 방법을 ...</p></div></div></a></div><div class="card"> <a href="/posts/K8S_Scheduling-manual/"><div class="card-body"> <em class="timeago small" data-ts="1660057200" > 2022-08-10 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>(K8S) 매뉴얼 스케줄링</h3><div class="text-muted small"><p> 이 글은 Mumshad Mannambeth가 강의한 Udemy의 Certified Kubernetes Administrator (CKA) with Practice Tests 강의 커리큘럼을 토대로 공부한 내용을 정리하였음을 밝힙니다. nodeName으로 직접 노드를 지정하여 스케줄링 쿠버네티스에서는 파드 정의 YAML 파일에서 nodeName을 ...</p></div></div></a></div><div class="card"> <a href="/posts/K8S_Taints-and-Tolerations/"><div class="card-body"> <em class="timeago small" data-ts="1660402800" > 2022-08-14 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>(K8S) 테인트와 톨러레이션</h3><div class="text-muted small"><p> 이 글은 Mumshad Mannambeth가 강의한 Udemy의 Certified Kubernetes Administrator (CKA) with Practice Tests 강의 커리큘럼을 토대로 공부한 내용을 정리하였음을 밝힙니다. 이번 글에서는 어떤 파드를 어떤 노드에 배치하는지, 즉 파드와 노드 간의 관계를 다룬다. 사람에게 들러붙으려는 ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/K8S_Taints-and-Tolerations/" class="btn btn-outline-primary" prompt="Older"><p>(K8S) 테인트와 톨러레이션</p></a> <a href="/posts/Taints-and-Tolerations-vs-Node-Affinity/" class="btn btn-outline-primary" prompt="Newer"><p>(K8S) 테인트와 톨러레이션 vs 노드 어피니티</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/zerojsh00">Sanghyeon</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/k8s/">K8S</a> <a class="post-tag" href="/tags/kubernetes/">Kubernetes</a> <a class="post-tag" href="/tags/paper-review/">Paper Review</a> <a class="post-tag" href="/tags/security/">Security</a> <a class="post-tag" href="/tags/network/">Network</a> <a class="post-tag" href="/tags/speech-ai/">Speech AI</a> <a class="post-tag" href="/tags/scheduling/">Scheduling</a> <a class="post-tag" href="/tags/nlp/">NLP</a> <a class="post-tag" href="/tags/storage/">Storage</a> <a class="post-tag" href="/tags/asr/">ASR</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/ko.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
